# =============================================================================
# NGURRA PATHWAYS - PRODUCTION ENVIRONMENT CONFIGURATION
# =============================================================================
# 
# SECURITY WARNING: Never commit this file with real values!
# Copy to .env and fill in production secrets.
#
# =============================================================================

# -----------------------------------------------------------------------------
# Core Settings
# -----------------------------------------------------------------------------
NODE_ENV=production
API_URL="https://api.ngurrapathways.com.au"
WEB_URL="https://ngurrapathways.com.au"
PORT=3001

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------
# Railway/Supabase/AWS RDS connection string
DATABASE_URL="postgresql://user:password@host:5432/ngurra_production?schema=public&sslmode=require"

# Connection pool settings
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# -----------------------------------------------------------------------------
# Authentication
# -----------------------------------------------------------------------------
# Generate with: openssl rand -base64 64
JWT_SECRET="REPLACE_WITH_64_CHAR_RANDOM_STRING"
JWT_EXPIRY="24h"

# Session management
SESSION_SECRET="REPLACE_WITH_ANOTHER_64_CHAR_RANDOM_STRING"
NEXTAUTH_SECRET="REPLACE_WITH_NEXTAUTH_SECRET"
NEXTAUTH_URL="https://ngurrapathways.com.au"

# -----------------------------------------------------------------------------
# Redis (Session/Cache)
# -----------------------------------------------------------------------------
REDIS_URL="redis://default:password@redis-host:6379"
REDIS_TLS=true

# -----------------------------------------------------------------------------
# AWS / S3 Storage
# -----------------------------------------------------------------------------
AWS_REGION="ap-southeast-2"
AWS_ACCESS_KEY_ID="AKIAXXXXXXXXXXXXXXXX"
AWS_SECRET_ACCESS_KEY="REPLACE_WITH_AWS_SECRET"
AWS_S3_BUCKET="ngurra-production"
AWS_S3_ENDPOINT=""  # Leave empty for AWS, or set for R2/MinIO

# CloudFront CDN (for S3 assets)
CDN_URL="https://cdn.ngurrapathways.com.au"

# -----------------------------------------------------------------------------
# Stripe Payments
# -----------------------------------------------------------------------------
STRIPE_SECRET_KEY="your_stripe_secret_key_here"
STRIPE_PUBLISHABLE_KEY="your_stripe_publishable_key_here"
STRIPE_WEBHOOK_SECRET="your_stripe_webhook_secret_here"

# Production Price IDs (from Stripe Dashboard)
STRIPE_PRICE_STARTER="price_XXXXXXXX"
STRIPE_PRICE_PROFESSIONAL="price_XXXXXXXX"
STRIPE_PRICE_ENTERPRISE="price_XXXXXXXX"
STRIPE_PRICE_RAP="price_XXXXXXXX"

# Stripe Connect (Mentor Payouts)
STRIPE_CONNECT_CLIENT_ID="ca_XXXXXXXX"

# -----------------------------------------------------------------------------
# PayPal (Alternative Payment)
# -----------------------------------------------------------------------------
PAYPAL_CLIENT_ID="PRODUCTION_CLIENT_ID"
PAYPAL_CLIENT_SECRET="PRODUCTION_CLIENT_SECRET"
PAYPAL_MODE="live"

# -----------------------------------------------------------------------------
# Email (SendGrid)
# -----------------------------------------------------------------------------
SENDGRID_API_KEY="SG.XXXXXXXXXXXXXXXXXXXXXXXX"
SENDGRID_FROM_EMAIL="hello@ngurrapathways.com.au"
SENDGRID_FROM_NAME="Ngurra Pathways"

# Email Templates (SendGrid Dynamic Templates)
SENDGRID_TEMPLATE_WELCOME="d-XXXXXXXX"
SENDGRID_TEMPLATE_PASSWORD_RESET="d-XXXXXXXX"
SENDGRID_TEMPLATE_APPLICATION_RECEIVED="d-XXXXXXXX"
SENDGRID_TEMPLATE_SESSION_REMINDER="d-XXXXXXXX"

# -----------------------------------------------------------------------------
# SMS (Twilio)
# -----------------------------------------------------------------------------
TWILIO_ACCOUNT_SID="ACXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
TWILIO_AUTH_TOKEN="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
TWILIO_PHONE_NUMBER="+61XXXXXXXXX"

# -----------------------------------------------------------------------------
# Push Notifications (Firebase)
# -----------------------------------------------------------------------------
FIREBASE_PROJECT_ID="ngurra-pathways"
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nXXXXXX\n-----END PRIVATE KEY-----"
FIREBASE_CLIENT_EMAIL="firebase-adminsdk@ngurra-pathways.iam.gserviceaccount.com"

# Web Push VAPID Keys (generate with web-push library)
VAPID_PUBLIC_KEY="BXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
VAPID_PRIVATE_KEY="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
VAPID_EMAIL="mailto:admin@ngurrapathways.com.au"

# -----------------------------------------------------------------------------
# AI / OpenAI
# -----------------------------------------------------------------------------
OPENAI_API_KEY="sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
OPENAI_MODEL="gpt-4-turbo-preview"
OPENAI_MAX_TOKENS=2000

# AI Rate Limiting
AI_RATE_LIMIT_REQUESTS=50
AI_RATE_LIMIT_WINDOW_MS=3600000

# -----------------------------------------------------------------------------
# Video Calling (Jitsi)
# -----------------------------------------------------------------------------
JITSI_DOMAIN="meet.jit.si"  # Or self-hosted domain
JITSI_APP_ID=""
JITSI_APP_SECRET=""

# -----------------------------------------------------------------------------
# OAuth Providers
# -----------------------------------------------------------------------------
# Google OAuth
GOOGLE_CLIENT_ID="XXXXXXXX.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="GOCSPX-XXXXXXXX"

# LinkedIn OAuth
LINKEDIN_CLIENT_ID="XXXXXXXX"
LINKEDIN_CLIENT_SECRET="XXXXXXXX"

# -----------------------------------------------------------------------------
# Monitoring & Observability
# -----------------------------------------------------------------------------
# Sentry Error Tracking
SENTRY_DSN="https://XXXXXXXX@o123456.ingest.sentry.io/1234567"
SENTRY_ENVIRONMENT="production"
SENTRY_TRACES_SAMPLE_RATE=0.1

# PostHog Analytics
POSTHOG_API_KEY="phc_XXXXXXXX"
POSTHOG_HOST="https://app.posthog.com"

# LogDNA / Papertrail
LOGDNA_KEY="XXXXXXXX"

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------
# CORS Origins (comma-separated)
CORS_ORIGINS="https://ngurrapathways.com.au,https://www.ngurrapathways.com.au"

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000

# IP Allowlist (admin endpoints, comma-separated)
ADMIN_IP_ALLOWLIST=""

# Content Security Policy
CSP_REPORT_URI="https://api.ngurrapathways.com.au/csp-report"

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
FEATURE_AI_ENABLED=true
FEATURE_VIDEO_CALLING=true
FEATURE_PAID_MENTORING=true
FEATURE_PUSH_NOTIFICATIONS=true
FEATURE_SMS_ALERTS=true

# -----------------------------------------------------------------------------
# Maintenance
# -----------------------------------------------------------------------------
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE="We're performing scheduled maintenance. Back soon!"

# -----------------------------------------------------------------------------
# Data Residency
# -----------------------------------------------------------------------------
DATA_REGION="AU"
DATA_RETENTION_DAYS=2555  # 7 years for compliance

# -----------------------------------------------------------------------------
# Media Processing
# -----------------------------------------------------------------------------
FFMPEG_PATH="/usr/bin/ffmpeg"
MAX_UPLOAD_SIZE_MB=50
ALLOWED_FILE_TYPES="image/jpeg,image/png,image/webp,application/pdf,video/mp4"

# -----------------------------------------------------------------------------
# Secrets Management (Phase B)
# -----------------------------------------------------------------------------
# Provider: environment, aws-secrets-manager, hashicorp-vault, azure-key-vault, gcp-secret-manager
SECRETS_PROVIDER="environment"

# AWS Secrets Manager
AWS_SECRETS_REGION="ap-southeast-2"

# HashiCorp Vault
VAULT_ADDR="https://vault.ngurrapathways.com.au"
VAULT_TOKEN="hvs.XXXXXXXXXXXXXXXXXXXXXXXX"
VAULT_SECRET_PATH="secret/data/ngurra"

# Azure Key Vault
AZURE_KEYVAULT_NAME="ngurra-production"

# GCP Secret Manager
GCP_PROJECT_ID="ngurra-pathways"

# Local encryption key (for fallback encryption)
LOCAL_SECRETS_KEY="REPLACE_WITH_64_CHAR_HEX_STRING"

# -----------------------------------------------------------------------------
# Horizontal Scaling (Phase B)
# -----------------------------------------------------------------------------
# PM2 Configuration
PM2_INSTANCES="max"
PM2_WORKER_INSTANCES=2

# Worker scaling thresholds
MIN_WORKERS=2
MAX_WORKERS=8

# Connection pooling
DB_POOL_MIN=2
DB_POOL_MAX=10

# Graceful shutdown
DRAIN_TIMEOUT_MS=30000

# -----------------------------------------------------------------------------
# Deployment (Phase B)
# -----------------------------------------------------------------------------
APP_VERSION="1.0.0"
INSTANCE_ID=""

# Railway-specific
RAILWAY_REPLICA_ID=""

# Deployment slot (blue/green)
DEPLOYMENT_SLOT="blue"

# -----------------------------------------------------------------------------
# CDN Configuration (Phase B)
# -----------------------------------------------------------------------------
# Provider: cloudflare, cloudfront, bunny, none
CDN_PROVIDER="cloudflare"

# Cloudflare
CLOUDFLARE_ZONE_ID="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
CLOUDFLARE_API_TOKEN="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"

# CloudFront
CLOUDFRONT_DISTRIBUTION_ID="E1XXXXXXXXXXXXXXX"

# Bunny CDN
BUNNY_PULL_ZONE_ID="12345"
BUNNY_API_KEY="XXXXXXXX"

# Asset URLs
STATIC_CDN_URL="https://static.ngurrapathways.com.au"
MEDIA_CDN_URL="https://media.ngurrapathways.com.au"

# -----------------------------------------------------------------------------
# Backup Configuration (Phase B)
# -----------------------------------------------------------------------------
BACKUP_DIR="/var/backups/ngurra"
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET="ngurra-backups"
BACKUP_ENCRYPTION_KEY="REPLACE_WITH_BACKUP_ENCRYPTION_KEY"

# Point-in-Time Recovery
PITR_ENABLED=true
PITR_RETENTION_DAYS=7
